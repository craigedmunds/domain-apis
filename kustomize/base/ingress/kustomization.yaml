apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

helmGlobals:
  chartHome: .

helmCharts:
  # Domain API ingress configuration
  - name: traefik-ingress
    releaseName: domain-api
    valuesInline:
      # Global configuration for lab environment
      domains:
        localDomainSuffix: lab.local.ctoaas.co
      tls:
        enabled: true
        issuer: letsencrypt-prod
      
      # Array of ingress configurations for domain API services
      ingresses:
        
        # API Gateway - internal access
        - service:
            name: gateway
            namespace: domain-api
            port:
              number: 80
          ingress:
            name: gateway
            accessPattern: internal
          domains:
            name: domain-api
          tls:
            secretName: domain-api-gateway-tls

        # Documentation - internal access
        - service:
            name: docs
            namespace: domain-api
            port:
              number: 80
          ingress:
            name: docs
            accessPattern: internal
          domains:
            name: domain-api-docs
          tls:
            secretName: domain-api-docs-tls

generatorOptions:
  disableNameSuffixHash: true
