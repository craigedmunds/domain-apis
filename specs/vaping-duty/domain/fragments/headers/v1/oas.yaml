# Platform Common Headers
# https://platform.hip.hmrc.gov.uk/common/headers.yaml

# Request Headers (as parameters)
X-Correlation-Id-Header:
  name: X-Correlation-Id
  in: header
  description: |
    Correlation ID for request tracing across services.
    If not provided, the platform will generate one.
  schema:
    type: string
    format: uuid
    example: "550e8400-e29b-41d4-a716-446655440000"
  required: false

X-Idempotency-Key-Header:
  name: X-Idempotency-Key
  in: header
  description: |
    Idempotency key for safe retries of non-idempotent operations (POST, PATCH, DELETE).

    The platform ensures:
    - Same key + same request = same response (cached)
    - Same key + different request = 409 Conflict

    Keys should be unique per logical operation (e.g., UUID, timestamp+nonce).
  schema:
    type: string
    minLength: 1
    maxLength: 255
    example: "abc-123-def-456"
  required: true

# Response Headers (as header objects)
X-Correlation-Id-Response:
  description: Correlation ID echoed from request or generated by platform
  schema:
    type: string
    format: uuid
    example: "550e8400-e29b-41d4-a716-446655440000"

ETag:
  description: |
    Entity tag for optimistic locking (RFC 7232).

    Use in conditional requests:
    - If-Match: Require ETag to match (for updates)
    - If-None-Match: Require ETag to NOT match (for caching)

    Format: W/"<version>-<hash>" (weak ETag)
  schema:
    type: string
    pattern: '^W/"[\w-]+"$'
    example: "W/3-6b1f"

Cache-Control:
  description: Cache control directives
  schema:
    type: string
    example: "no-cache, no-store, must-revalidate"

X-RateLimit-Limit:
  description: Maximum number of requests allowed in the current time window
  schema:
    type: integer
    example: 100

X-RateLimit-Remaining:
  description: Number of requests remaining in the current time window
  schema:
    type: integer
    example: 95

X-RateLimit-Reset:
  description: Unix timestamp when the rate limit window resets
  schema:
    type: integer
    format: int64
    example: 1706371200
